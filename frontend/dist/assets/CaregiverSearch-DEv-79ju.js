import{f as m,l as C,c as r,a as g,b as t,g as c,i as p,v as x,m as M,t as i,F as V,p as N,j as T,r as $,o as d,e as f,w as U,s as B}from"./index-t9rlBETP.js";import{N as F}from"./Navbar-CypzDj8e.js";const H={class:"bg-gray-50 min-h-screen"},L={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},j={class:"card mb-6 p-4 bg-white rounded shadow"},D={key:0,class:"text-center py-8"},P={key:1,class:"text-center py-8 text-gray-600"},A={key:2,class:"space-y-4"},E=["onClick"],G={class:"flex justify-between items-start"},I={class:"flex-1"},R={class:"text-xl font-semibold text-gray-800 mb-2"},q={class:"space-y-2 text-gray-600"},z={class:"flex items-center"},J={class:"flex items-center"},K=["innerHTML"],O={class:"ml-2"},Q={class:"ml-4"},Z={__name:"CaregiverSearch",setup(W){const y=T(),l=m({address:"",gender:"",min_rating:null,start_date:""}),u=m([]),v=m(!1),b=m(!1),_=n=>n==="male"?"男性":n==="female"?"女性":"未提供",w=n=>{const e=Math.floor(n),a=n%1>=.5;let s="";for(let o=0;o<e;o++)s+='<span class="text-yellow-400">★</span>';a&&(s+='<span class="text-yellow-400">☆</span>');for(let o=e+(a?1:0);o<5;o++)s+='<span class="text-gray-300">★</span>';return s},k=async()=>{var n,e;v.value=!0,b.value=!0;try{const a={};l.value.address&&(a.address=l.value.address),l.value.gender&&(a.gender=l.value.gender),l.value.min_rating&&(a.min_rating=l.value.min_rating),l.value.start_date&&(a.start_date=l.value.start_date);const s=await B.search(a);u.value=s.profiles||s||[]}catch(a){console.error("Search error:",a),alert("搜尋失敗："+(((e=(n=a.response)==null?void 0:n.data)==null?void 0:e.error)||a.message))}finally{v.value=!1}},h=()=>{l.value={address:"",gender:"",min_rating:null,start_date:""},u.value=[],b.value=!1},S=n=>{y.push(`/caregiver/${n}`)};return C(()=>{}),(n,e)=>{const a=$("router-link");return d(),r("div",null,[g(F),t("div",H,[t("div",L,[e[18]||(e[18]=t("h2",{class:"text-3xl font-bold mb-6 text-gray-800"},"搜尋照護者",-1)),t("div",j,[e[11]||(e[11]=t("h3",{class:"text-lg font-semibold mb-4"},"搜尋條件",-1)),t("form",{onSubmit:c(k,["prevent"]),class:"grid md:grid-cols-4 gap-4"},[t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"地點",-1)),p(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>l.value.address=s),type:"text",class:"input-field border p-2 w-full",placeholder:"例如：台北"},null,512),[[x,l.value.address]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"性別",-1)),p(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.gender=s),class:"input-field border p-2 w-full"},[...e[6]||(e[6]=[t("option",{value:""},"不限",-1),t("option",{value:"male"},"男性",-1),t("option",{value:"female"},"女性",-1)])],512),[[M,l.value.gender]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"最低評分",-1)),p(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.min_rating=s),type:"number",min:"0",max:"5",step:"0.1",class:"input-field border p-2 w-full",placeholder:"0"},null,512),[[x,l.value.min_rating,void 0,{number:!0}]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"開始日期",-1)),p(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.start_date=s),type:"date",class:"input-field border p-2 w-full"},null,512),[[x,l.value.start_date]])]),t("div",{class:"md:col-span-4 mt-4"},[e[10]||(e[10]=t("button",{type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"}," 搜尋 ",-1)),t("button",{type:"button",onClick:h,class:"bg-gray-500 text-white px-4 py-2 rounded ml-2 hover:bg-gray-600"}," 重置 ")])],32)]),v.value?(d(),r("div",D,[...e[12]||(e[12]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1),t("p",{class:"mt-4 text-gray-600"},"載入中...",-1)])])):u.value.length===0?(d(),r("div",P,i(b.value?"沒有找到符合條件的照護者":"請輸入搜尋條件開始搜尋"),1)):(d(),r("div",A,[(d(!0),r(V,null,N(u.value,s=>(d(),r("div",{key:s.profile_id||s.user_id,class:"card bg-white p-4 rounded shadow hover:shadow-xl transition-shadow cursor-pointer mb-4",onClick:o=>S(s.user_id)},[t("div",G,[t("div",I,[t("h3",R,i(s.full_name||"未提供姓名"),1),t("div",q,[t("p",null,[e[13]||(e[13]=t("span",{class:"font-medium"},"地點：",-1)),f(i(s.address||"未提供"),1)]),t("p",null,[e[14]||(e[14]=t("span",{class:"font-medium"},"性別：",-1)),f(i(_(s.gender)),1)]),t("p",null,[e[15]||(e[15]=t("span",{class:"font-medium"},"時薪：",-1)),f("NT$ "+i(s.service_rate||"0"),1)]),t("div",z,[e[16]||(e[16]=t("span",{class:"font-medium mr-2"},"評分：",-1)),t("div",J,[t("span",{innerHTML:w(s.avg_rating||0)},null,8,K),t("span",O,i((s.avg_rating||0).toFixed(1)),1)])])])]),t("div",Q,[g(a,{to:`/create-contract/${s.user_id}?profile_id=${s.profile_id||""}`,class:"bg-blue-600 text-white px-4 py-2 rounded inline-block hover:bg-blue-700",onClick:e[4]||(e[4]=c(()=>{},["stop"]))},{default:U(()=>[...e[17]||(e[17]=[f(" 發起合約 ",-1)])]),_:1},8,["to"])])])],8,E))),128))]))])])])}}};export{Z as default};

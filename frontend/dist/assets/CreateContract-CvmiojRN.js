import{f as i,C as I,l as C,k as N,j as S,s as T,c as r,a as V,b as e,h as v,t as u,g as M,i as k,e as g,v as D,o as l,q}from"./index-t9rlBETP.js";import{N as $}from"./Navbar-CypzDj8e.js";const B={class:"bg-gray-50 min-h-screen"},P={class:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},j={class:"card"},A={key:0,class:"mb-6 p-4 bg-primary-50 rounded-lg"},O={key:1,class:"mb-6 p-4 bg-primary-50 rounded-lg"},R={class:"font-semibold text-gray-800 mb-2"},U={class:"text-sm text-gray-600"},E={key:0},F={key:1,class:"ml-4"},L={key:0,class:"text-sm text-gray-600 mt-1"},z=["value"],G={class:"grid md:grid-cols-2 gap-6"},H=["min"],J=["min"],K={key:0,class:"text-red-600 text-sm bg-red-50 p-3 rounded-md border border-red-100"},Q={class:"flex justify-end space-x-4"},W=["disabled"],te={__name:"CreateContract",setup(X){const b=N(),y=S(),c=i(null),s=i(null),_=i(!1),a=i({start_date:"",end_date:""}),n=i(""),m=i(!1),f=I(()=>new Date().toISOString().split("T")[0]);C(async()=>{if(c.value=b.params.caregiverId||b.query.caregiver_id,!c.value){alert("ç¼ºå°‘ç…§è­·è€…è³‡è¨Š"),y.push("/caregiver-search");return}_.value=!0;try{s.value=await T.getProfile(c.value)}catch(t){console.error("Load caregiver error:",t)}finally{_.value=!1}const o=new Date().toISOString().split("T")[0];a.value.start_date=o,a.value.end_date=o});const w=async()=>{var x,h;if(n.value="",new Date(a.value.start_date)>=new Date(a.value.end_date)){n.value="çµæŸæ—¥æœŸå¿…é ˆæ™šæ–¼é–‹å§‹æ—¥æœŸ";return}const o=new Date(a.value.start_date),t=new Date(a.value.end_date),d=Math.abs(t-o);if(Math.ceil(d/(1e3*60*60*24))>180){n.value="åˆç´„æœŸé™æœ€é•·ç‚º 180 å¤©";return}m.value=!0;try{const p=await q.createContract({caregiver_id:parseInt(c.value),start_date:a.value.start_date,end_date:a.value.end_date});alert("åˆç´„å·²ç™¼èµ·ï¼"),y.push(`/contract/${p.contract_id}`)}catch(p){n.value=((h=(x=p.response)==null?void 0:x.data)==null?void 0:h.error)||p.message||"å»ºç«‹åˆç´„å¤±æ•—"}finally{m.value=!1}};return(o,t)=>(l(),r("div",null,[V($),e("div",B,[e("div",P,[t[7]||(t[7]=e("h2",{class:"text-3xl font-bold mb-6 text-gray-800"},"ç™¼èµ·æ–°åˆç´„",-1)),e("div",j,[_.value?(l(),r("div",A,[...t[3]||(t[3]=[e("p",{class:"text-gray-600"},"è¼‰å…¥ç…§è­·è€…è³‡è¨Šä¸­...",-1)])])):s.value?(l(),r("div",O,[e("h3",R,u(s.value.full_name||"ç…§è­·è€…"),1),e("p",U,[s.value.address?(l(),r("span",E,"ğŸ“ "+u(s.value.address),1)):v("",!0),s.value.service_rate?(l(),r("span",F,"ğŸ’° NT$ "+u(s.value.service_rate)+"/å°æ™‚",1)):v("",!0)]),s.value.avg_rating?(l(),r("p",L," â­ è©•åˆ†ï¼š"+u(s.value.avg_rating.toFixed(1)),1)):v("",!0)])):v("",!0),e("form",{onSubmit:M(w,["prevent"]),class:"space-y-6"},[e("input",{type:"hidden",value:c.value},null,8,z),e("div",G,[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[g(" åˆç´„é–‹å§‹æ—¥æœŸ "),e("span",{class:"text-red-500"},"*")],-1)),k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=d=>a.value.start_date=d),type:"date",required:"",class:"input-field",min:f.value},null,8,H),[[D,a.value.start_date]])]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[g(" åˆç´„çµæŸæ—¥æœŸ "),e("span",{class:"text-red-500"},"*")],-1)),k(e("input",{"onUpdate:modelValue":t[1]||(t[1]=d=>a.value.end_date=d),type:"date",required:"",class:"input-field",min:f.value},null,8,J),[[D,a.value.end_date]])])]),t[6]||(t[6]=e("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},[e("p",{class:"text-sm text-blue-800"},[e("strong",null,"æ³¨æ„ï¼š"),g("åˆç´„æœŸé™æœ€é•·ç‚º 180 å¤©ï¼ˆ6å€‹æœˆï¼‰ã€‚çµæŸæ—¥æœŸå¿…é ˆæ™šæ–¼é–‹å§‹æ—¥æœŸã€‚ ")])],-1)),n.value?(l(),r("div",K,u(n.value),1)):v("",!0),e("div",Q,[e("button",{type:"button",onClick:t[2]||(t[2]=d=>o.$router.back()),class:"btn-secondary"}," å–æ¶ˆ "),e("button",{type:"submit",disabled:m.value,class:"btn-primary"},u(m.value?"è™•ç†ä¸­...":"ç™¼èµ·åˆç´„"),9,W)])],32)])])])]))}};export{te as default};

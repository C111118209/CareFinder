import{u as S,f as p,l as U,k as V,j as B,c as l,a as y,b as t,h as u,w as E,r as I,t as o,x as j,e as n,n as _,q as g,s as z,o as i}from"./index-t9rlBETP.js";import{N as L}from"./Navbar-CypzDj8e.js";const R={class:"bg-gray-50 min-h-screen"},q={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},W={class:"mb-4"},$={key:0,class:"text-center py-10"},F={key:1,class:"space-y-6"},G={class:"bg-white p-6 rounded-lg shadow-md border border-gray-200"},H={class:"flex justify-between items-start mb-4"},J={class:"text-2xl font-semibold mb-2"},K={key:0,class:"ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded"},O={class:"grid md:grid-cols-2 gap-4 text-gray-700"},Q={key:0},X={class:"bg-white p-6 rounded-lg shadow-md border-l-4 border-blue-500"},Y={class:"grid md:grid-cols-2 gap-6"},Z={key:0},ee={key:0},te={key:1},se={key:2},ae={key:0,class:"mt-4 pt-4 border-t"},re={class:"text-gray-700"},oe={class:"bg-white p-6 rounded-lg shadow-md border-l-4 border-green-500"},ne={class:"grid md:grid-cols-2 gap-6"},le={key:0,class:"bg-white p-6 rounded-lg shadow-md"},ie={key:1,class:"bg-white p-6 rounded-lg shadow-md"},me={__name:"ContractDetails",setup(de){const b=V(),c=B(),f=S(),a=p(null),d=p(null),m=p(!1),v=s=>{if(!s)return"ç„¡è³‡æ–™";const e=new Date(s);return isNaN(e.getTime())?"æ ¼å¼éŒ¯èª¤":e.toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"})},h=s=>({pending:"å¾…æ¥å—",active:"é€²è¡Œä¸­",completed:"å·²å®Œæˆ",canceled:"å·²å–æ¶ˆ"})[s]||s,w=s=>{const e=s.Caregiver||s.caregiver||{};return e.nickname||e.email||"æœªæä¾›"},k=s=>(s.Caregiver||s.caregiver||{}).email||"æœªæä¾›",C=s=>{const e=s.User||s.user||{};return e.nickname||e.email||"æœªæä¾›"},N=s=>(s.User||s.user||{}).email||"æœªæä¾›",D=(s,e)=>{const r=new Date(s),x=new Date(e),A=Math.abs(x-r);return Math.ceil(A/(1e3*60*60*24))||0},T=async()=>{var s,e;if(confirm("ç¢ºå®šè¦æ¥å—é€™å€‹åˆç´„å—ï¼Ÿ"))try{await g.acceptContract(a.value.contract_id),a.value.status="active",alert("åˆç´„å·²æ¥å—"),c.push("/contracts")}catch(r){alert("æ“ä½œå¤±æ•—ï¼š"+(((e=(s=r.response)==null?void 0:s.data)==null?void 0:e.error)||r.message))}},M=async()=>{var s,e;if(confirm("ç¢ºå®šè¦å®Œæˆé€™å€‹åˆç´„å—ï¼Ÿ"))try{await g.completeContract(a.value.contract_id),a.value.status="completed",alert("åˆç´„å·²å®Œæˆ"),c.push("/contracts")}catch(r){alert("æ“ä½œå¤±æ•—ï¼š"+(((e=(s=r.response)==null?void 0:s.data)==null?void 0:e.error)||r.message))}},P=async()=>{var s,e;m.value=!0;try{const r=b.params.id;if(a.value=await g.getContract(r),a.value.caregiver_id)try{d.value=await z.getProfile(a.value.caregiver_id)}catch{console.log("ç„¡æ³•å–å¾—é¡å¤– Profile è³‡è¨Š")}}catch(r){console.error("Load contract error:",r),alert("è¼‰å…¥å¤±æ•—ï¼š"+(((e=(s=r.response)==null?void 0:s.data)==null?void 0:e.error)||r.message)),c.push("/contracts")}finally{m.value=!1}};return U(()=>{if(!b.params.id){c.push("/contracts");return}P()}),(s,e)=>{const r=I("router-link");return i(),l("div",null,[y(L),t("div",R,[t("div",q,[t("div",W,[y(r,{to:"/contracts",class:"text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium"},{default:E(()=>[...e[0]||(e[0]=[n(" â† è¿”å›åˆç´„åˆ—è¡¨ ",-1)])]),_:1})]),e[16]||(e[16]=t("h2",{class:"text-3xl font-bold mb-6 text-gray-800"},"åˆç´„è©³æƒ…",-1)),m.value?(i(),l("div",$,[...e[1]||(e[1]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1),t("p",{class:"mt-4 text-gray-600"},"è¼‰å…¥ä¸­...",-1)])])):a.value?(i(),l("div",F,[t("div",G,[t("div",H,[t("div",null,[t("h3",J,"åˆç´„ #"+o(a.value.contract_id),1),t("span",{class:j([{"bg-yellow-100 text-yellow-800":a.value.status==="pending","bg-green-100 text-green-800":a.value.status==="active","bg-blue-100 text-blue-800":a.value.status==="completed","bg-red-100 text-red-800":a.value.status==="canceled"},"px-3 py-1 rounded-full text-sm font-medium"])},o(h(a.value.status)),3),a.value.is_renewal?(i(),l("span",K," çºŒç´„ ")):u("",!0)])]),t("div",O,[t("div",null,[t("p",null,[e[2]||(e[2]=t("span",{class:"font-medium"},"é–‹å§‹æ—¥æœŸï¼š",-1)),n(o(v(a.value.start_date)),1)]),t("p",null,[e[3]||(e[3]=t("span",{class:"font-medium"},"çµæŸæ—¥æœŸï¼š",-1)),n(o(v(a.value.end_date)),1)])]),t("div",null,[t("p",null,[e[4]||(e[4]=t("span",{class:"font-medium"},"åˆç´„æœŸé–“ï¼š",-1)),n(o(D(a.value.start_date,a.value.end_date))+" å¤©",1)]),a.value.created_at?(i(),l("p",Q,[e[5]||(e[5]=t("span",{class:"font-medium"},"å»ºç«‹æ™‚é–“ï¼š",-1)),n(o(v(a.value.created_at)),1)])):u("",!0)])])]),t("div",X,[e[12]||(e[12]=t("h3",{class:"text-xl font-semibold mb-4 text-blue-800 flex items-center"},[t("span",{class:"mr-2"},"ğŸ‘¤"),n(" ç…§è­·è€…è©³ç´°è³‡æ–™ ")],-1)),t("div",Y,[t("div",null,[t("p",null,[e[6]||(e[6]=t("span",{class:"font-medium"},"æš±ç¨±ï¼š",-1)),n(o(w(a.value)),1)]),t("p",null,[e[7]||(e[7]=t("span",{class:"font-medium"},"é›»å­éƒµä»¶ï¼š",-1)),n(o(k(a.value)),1)])]),d.value?(i(),l("div",Z,[d.value.phone?(i(),l("p",ee,[e[8]||(e[8]=t("span",{class:"font-medium"},"é›»è©±ï¼š",-1)),n(o(d.value.phone),1)])):u("",!0),d.value.address?(i(),l("p",te,[e[9]||(e[9]=t("span",{class:"font-medium"},"åœ°å€ï¼š",-1)),n(o(d.value.address),1)])):u("",!0),d.value.service_rate?(i(),l("p",se,[e[10]||(e[10]=t("span",{class:"font-medium"},"æ™‚è–ªï¼š",-1)),n("NT$ "+o(d.value.service_rate)+"/å°æ™‚ ",1)])):u("",!0)])):u("",!0)]),d.value&&d.value.bio?(i(),l("div",ae,[e[11]||(e[11]=t("p",{class:"font-medium mb-2"},"ç°¡ä»‹ï¼š",-1)),t("p",re,o(d.value.bio),1)])):u("",!0)]),t("div",oe,[e[15]||(e[15]=t("h3",{class:"text-xl font-semibold mb-4 text-green-800 flex items-center"},[t("span",{class:"mr-2"},"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦"),n(" å®¶å±¬è©³ç´°è³‡æ–™ ")],-1)),t("div",ne,[t("div",null,[t("p",null,[e[13]||(e[13]=t("span",{class:"font-medium"},"æš±ç¨±ï¼š",-1)),n(o(C(a.value)),1)]),t("p",null,[e[14]||(e[14]=t("span",{class:"font-medium"},"é›»å­éƒµä»¶ï¼š",-1)),n(o(N(a.value)),1)])])])]),a.value.status==="pending"&&_(f).isCaregiver?(i(),l("div",le,[t("button",{onClick:T,class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium"}," æ¥å—åˆç´„ ")])):u("",!0),a.value.status==="active"&&_(f).isCaregiver?(i(),l("div",ie,[t("button",{onClick:M,class:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-medium"}," å®Œæˆåˆç´„ ")])):u("",!0)])):u("",!0)])])])}}};export{me as default};
